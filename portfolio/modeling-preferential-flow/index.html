<!DOCTYPE html>
<html lang="en">

<!-- Head -->

<head> <!-- Metadata, OpenGraph and Schema.org -->


    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Eunice Koid | Modeling Preferential Flow</title>
    <meta name="author" content="Eunice Koid" />
    <meta name="description" content="" />
    <meta name="keywords" content="environmental-engineering, richards-equation, preferential-flow, dual-porosity" />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css"
        integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Quicksand:300,400,500,700&display=swap">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css"
        integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css"
        integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <!-- <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> -->

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css"
        media="none" id="highlight_theme_light" />

    <!-- Styles -->

    <link rel="shortcut icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>◼️</text></svg>">

    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://eunicekoid.github.io/projects/forest-coverage-covid-19-india-machine-learning/">

    <!-- Dark Mode -->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css"
        media="none" id="highlight_theme_dark" />

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    <style>
        body {
            margin-left: 2px;
            /* Adjust the margin to accommodate the fixedNavigation */
        }

        .fixedNavigation {
            position: fixed;
            top: 1000;
            width: 2750px;
            left: 10;
            padding: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            font-size: 15px;
        }

        .submenu {
            margin-left: 3px;
            font-size: 11px;
        }

        @media only screen and (max-width: 600px) {
            .fixedNavigation {
                display: none;
            }
        }
    </style>

</head>

<!-- Body -->

<body class="fixed-top-nav ">

    <!-- Header -->
    <header>

        <!-- Nav Bar -->
        <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
            <div class="container">
                <a class="navbar-brand title font-weight-lighter" href="https://eunicekoid.github.io/"><span
                        class="font-weight-bold">Eunice</span> Koid</a>
                <!-- Navbar Toggle -->
                <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse"
                    data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"
                    aria-label="Toggle navigation">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar top-bar"></span>
                    <span class="icon-bar middle-bar"></span>
                    <span class="icon-bar bottom-bar"></span>
                </button>

                <div class="collapse navbar-collapse text-right" id="navbarNav">
                    <ul class="navbar-nav ml-auto flex-nowrap">

                        <!-- About -->
                        <li class="nav-item ">
                            <a class="nav-link" href="/">about</a>
                        </li>

                        <!-- Portfolio -->
                        <li class="nav-item ">
                            <a class="nav-link" href="/portfolio/">portfolio</a>
                        </li>

                        <!-- Blog -->
                        <li class="nav-item ">
                            <a class="nav-link" href="/blog/">blog</a>
                        </li>


                        <!-- Studying -->
                        <li class="nav-item ">
                            <a class="nav-link" href="/study/">study</a>
                        </li>

                        <!-- Toogle theme mode -->
                        <div class="toggle-container">
                            <a id="light-toggle">
                                <i class="fas fa-moon"></i>
                                <i class="fas fa-sun"></i>
                            </a>
                        </div>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <div class="fixedNavigation">
        <a href="#theory">Theory and Basic Equations</a>
        <div class="submenu">
            <a href="#darcy">Darcy's Law</a><br>
            <a href="#effective">Relative Permeability</a><br>
            <a href="#richard">Richard's Equation</a><br>
            <a href="#dual">Dual Porosity Concept</a><br>
        </div>
        <br />
        <a href="#methodology">Methodology</a>
        <div class="submenu">
            <a href="#parameter">Parameter Values and Initial Conditions</a><br>
        </div>
        <br />
        <a href="#scenarios">Scenarios</a>
        <div class="submenu">
            <a href="#scenario1">Gravity bottom, <small>\(k_{ex} = 0\)</small></a><br>
            <a href="#scenario2">Robbin bottom, <small>\(k_{ex} = 0\)</small></a><br>
            <a href="#scenario3">Gravity bottom, <small>\(k_{ex} = 1.05\times10^{-5} m^2/d\)</small> </a><br>
            <a href="#scenario4">Robbin bottom, <small>\(k_{ex} = 1.05\times10^{-5} m^2/d\)</small> </a><br>
            <a href="#scenario5">Gravity bottom, <small>\(k_{ex} = 1.05\times10^{-4} m^2/d\)</small> </a><br>
            <a href="#scenario6">Robbin bottom, <small> \(k_{ex} = 1.05\times10^{-4} m^2/d\)</small> </a><br>
            <a href="#scenario7">Gravity bottom, <small> \(k_{ex} = 1.05\times10^{-5} m^2/d\)</small>, ponding & varying top</a><br>
            <a href="#scenario8">Gravity bottom, <small>\(k_{ex} = 1.05\times10^{-5} m^2/d\)</small>, ponding & higher inflow</a><br>
        </div>
        <br />
        <a href="#conclusion">Conclusion</a>
        <div class="submenu">
            <a href="#future">Future Extensions of the Model </a><br>
        </div>
        <br />
        <a href="#appendix">Appendix</a>
    </div>

    <!-- Content -->
    <div class="container mt-5">
        <!-- page.html -->
        <div class="post">

            <header class="post-header">
                <h1 class="post-title">Modeling Preferential Flow through Unsaturated Soil using the 1-D
                    Dual Porosity
                    Approach</h1>
                <p class="post-description"></p>
            </header>
            <br>
            <a href="https://github.com/eunicekoid/Portfolio/tree/main/Modeling%20Preferential%20Flow%20through%20Unsaturated%20Soil"
                style="font-size: 16px;">
                <u>View code on Github</u>
            </a>
            <style>
                .scaled-image-icons {
                    width: 40%;
                }
            </style>
            <br>
            <img class="img-fluid z-dept-1 rounded scaled-image-icons" src="/assets/img/icons_pf.png"
                alt="icons_pf.png" />
            <br>
            <hr>


            <article>
                <p>This model, written in Python, expands upon the Richards Equation for the movement of
                    water through
                    unsaturated soils to include preferential flow. Preferential flow occurs when there are
                    cracks or
                    holes in the soil due to, for example, plowing that breaks up aggregates, roots, or
                    wormholes,
                    allowing uneven movement of water through porous media like soils (Cornell University,
                    2021). The
                    cracks and holes allow for faster water flow than the bulk of the soil. These areas also
                    allow for
                    deeper penetration of water, which could have implications for groundwater quality
                    (Cornell
                    University, 2021).
                </p>

                <p>The code extends the Richards equation to model two fractions in the soil: 1. Fast flow
                    zone, and 2.
                    Slow flow zone. The total flow through porous soil media is determined by the flow in
                    these two
                    domains, modeled using a staggered grid scheme. In this way, the dual porosity concept
                    was
                    implemented where the fast and slow flow zones are described separately; this is
                    appropriate as
                    these zones could have different soil properties. The model couples the preferential
                    flow and
                    unsaturated flow processes to investigate how water flows through porous media under
                    various
                    conditions using different scenarios.
                </p>


                <h2 id="theory">Theory and Basic Equations</h2>

                <h4 id="darcy">Darcy's Law</h4>
                <p>Concepts that drive the rate of water flow through porous media, such as capillary
                    pressure,
                    hydraulic head and fluid potential, are related to the energy gradient in Darcy’s Law
                    (Pinder and
                    Celia, 2006). The model uses the extended form of Darcy’s law for groundwater flow, as
                    it describes
                    the simultaneous flow of non-homogeneous phases (Mayer, 2005). The modeled system has
                    non-homogeneous phases because it is a porous medium where two immiscible phases are
                    present; this
                    is needed to create capillary pressure that retains water (Mayer, 2005). The extended
                    form of
                    Darcy’s equation is:
                </p>


                <p>$$q_{\alpha} =
                    \frac{\textbf{k}k_{r\alpha}}{\mu_{\alpha}}(\mathbf{\nabla}p_{\alpha}-\rho_{\alpha}\textbf{g})$$
                </p>

                <p>where \(q_{\alpha}\) is the water discharge rate in \(\frac{L^2}{T}\), \(\textbf{k}\) is
                    the
                    permeability
                    in \(L^2\), \(k_{r\alpha}\) is the relative permeability (dimensionless),
                    \(\mu_{\alpha}\) is the
                    dynamic
                    viscosity in Pascals \(\cdot\) T,
                    \((\mathbf{\nabla}p_{\alpha}-\rho_{\alpha}\textbf{g})\) is the
                    pressure gradient. Note that L indicates a length-based unit like meters and T indicates
                    a
                    time-based unit like seconds.
                </p>



                <h4 id="effective">Effective Saturation, Van Genuchten, and Relative Permeability</h4>
                <p>The Van Genuchten and effective saturation equations are needed to calculate the relative
                    permeability, \(k_{r\alpha}\). The Van Genuchten equation models the soil's water
                    retention by
                    relating the water content to the soil’s empirical parameters (Mayer, 2005; Pinder and
                    Celia, 2006).
                </p>

                <p>$$\text{if } h_c > 0 \text{, } S_{\text{eff}}(h_c) = [1 + (\alpha h_c)^n]^{-m}$$</p>
                <p>$$\text{if } h_c \leq 0 \text{, } S_{\text{eff}}(h_c) = 1$$</p>

                <p>where \(\alpha\) is an empirical parameter of the soil in \(L^{-1}\) which is the point
                    on the water
                    retention curve where \(S_{eff}=0\). \(h_{c}\) is the capillary pressure head in
                    length-based unit.
                    \(n\) and \(m\) are empirical soil parameters where \(n=\frac{1}{1-m}\) and
                    \(m=1-(\frac{1}{n})\)
                    (Mayer,
                    2005).
                    With \(S_{eff}\) known using the equation above, the volumetric water content,
                    \(\theta_{w}\) \((L^3
                    L^{-3})\), can be calculated via the effective saturation equation as shown in the
                    following
                    equation.</p>

                <p>$$S_{eff} = \frac{\theta_{w}-\theta_{res}}{\theta_{sat}-\theta_{res}}$$</p>

                <p>while the relative permeability can be found by the following equation (Pinder and Celia,
                    2006)</p>

                <p>$$k_{rw} = (S_{eff})^3$$</p>

                <h4 id="richard">Richard's Equation</h4>
                <p>The pressure head form of the Richards Equation is as follows.
                </p>

                <p>$$[C(h_{w}) + S_{w}S^w_{s}]\frac{\delta h_{w}}{\delta t} - \mathbf{\nabla} \cdot
                    [K^w_{sat}
                    k_{rw}(\mathbf{\nabla} h_{w} + \mathbf{\nabla}z)]=0$$</p>

                <p>where \(K^w_{sat}\) is the saturated hydraulic conductivity in \(\frac{L}{T}\), \(h_{w}\)
                    is the
                    water
                    pressure head, and \(z\) is the depth. Note that negative \(z\) indicates a direction
                    from top to
                    bottom
                    of the soil column (away from the surface into deeper layers). \(C(h_{w})\) is the
                    differential
                    water
                    capacity which equals \(\frac{\delta \theta_{w}}{\delta h_{w}}\). \(S_{w}\) is known as
                    the water
                    storage which equals \(\frac{\theta_{w}}{\theta_{sat}}\).</p>

                <p>\(S^w_{s}\) is the storativity coefficient which is the specific water capacity of the
                    soil, given by
                    the following equation.</p>

                <p>$$S^w_{s} = \rho_{w} g (C_v+\epsilon \beta_w)$$</p>

                <p>where \(C_v\) is the compressibility of the soil, \(\epsilon\) is the porosity of the
                    soil,
                    \(\beta_w\) is
                    the compressibility of water, \(\rho_w\) is the density of water, and \(g\) is
                    gravitational
                    acceleration.</p>

                <h4 id="dual">Dual Porosity Concept</h4>

                <p>In the dual porosity model, the fast flow fraction can have different soil properties
                    than the slow
                    flow fraction; a Darcy’s Law-based water flow is considered for both porosity systems by
                    using a
                    "first-order coupling term" (Gerke and Van Genuchten, 1993). In this model, the
                    densities of both
                    the solid and liquid phases are constant, and temperature, air pressure, and solute
                    concentration
                    effects are considered to be negligible (Gerke and Van Genuchten, 1993).</p>

                <p>The fast and slow flows are modeled based on the extended form of Darcy’s Law.</p>

                <p>$$q_{w} = -K_{sat}k_{rel}(\theta_{w}) ({\Delta} h_w+\mathbf{\nabla}z)$$</p>

                <p>where \(q_w\), \(K_{sat}\), \(k_{rel}\), and \(h_w\) are unique to the respective fast
                    flow and slow
                    flow
                    domains. The hydraulic conductivity, \(-K_{sat}k_{rel}\), is a function of the water
                    content.</p>

                <p>In the model, the flows in both the fast and slow zones are coupled by the exchange for
                    water term
                    \(Q_{exchange}\).</p>

                <p>$$Q_{exchange} = -k_{ex}(h_{w,fast}-h_{w,slow})$$</p>

                <p>where \(k_{ex}\) is the rate of exchange of water between the two porosities and \(h_w\)
                    is the water
                    pressure head for the fast and slow zones. \(k_{ex}\) is a resistance term and expected
                    to be large
                    if
                    there is a barrier like a worm's slimy paste that keeps the holes in place; this
                    interface presents
                    a higher resistivity. Since it is an empirical parameter, it is determined by trial and
                    error. The
                    \(Q_{exchange}\) term has the same magnitude at all times for both flow zones, but with
                    different
                    signs in each respective soil fraction. The saturated water content is denoted by the
                    following
                    equation.</p>

                <p>$$\theta_{sat} = \theta_{sat,fast} + \theta_{sat,slow}$$</p>

                <p>where \(\theta_{sat,fast} = \beta \theta_{sat}\) and \(\theta_{sat,slow} = (1-\beta)
                    \theta_{sat}\).
                    \(\beta\) is the fraction of porosity associated with the fast flow.</p>

                <p>The water mass balances for both the fast and slow flow zones, respectively, are as
                    follows.</p>

                <p>$$\frac{\delta \theta_{w,fast}}{\delta t} + \mathbf{\nabla} \cdot q_{w,fast} +
                    Q_{exchange} =0$$</p>

                <p>$$\frac{\delta \theta_{w,slow}}{\delta t} + \mathbf{\nabla} \cdot q_{w,slow} -
                    Q_{exchange} =0$$</p>

                <p>If the \(h_{w,fast}\) > \(h_{h,slow}\), then the \(Q_{exchange}\) is negative, indicating
                    that the
                    water flows from the fast flow zone to the slow flow zone.</p>


                <h2 id="methodology">Methodology</h2>
                <p>To implement the equations in the model, the following steps were taken. Firstly, both
                    domains were
                    defined to have the same top and boundary conditions and the same number of nodes; the
                    soil column
                    used for both is the same. The flow was assumed to enter through the fast flow zone
                    only. The
                    Richards Equation was modeled with two states with identical soil properties and a
                    \(Q_{exchange}\)
                    of
                    zero to see if the model produced identical results as unsaturated flow, as in this
                    case, there is
                    no exchange between the zones. The model solves both of the states of the two domains in
                    parallel.
                    The fast flow zone is controlled by \(\beta\), with \(\beta \theta_{sat}\) indicating
                    the pore space
                    in
                    the fast flow zone. Then, the parameters were varied to have different soil parameters
                    to study the
                    behavior of the fast and slow flow zones. After that, the exchange term can be also
                    changed to model
                    the preferential flow. From the exchange term, \(Q_{exchange}\), it is evident that the
                    difference
                    between the pressure heads of the fast and slow flow zones and therefore the
                    \(Q_{exchange}\) will
                    dominate the flow process. To see the results of this stepwise expansion of the model,
                    please see
                    the Appendix. The model was then used to run different scenarios to see the effect of
                    preferential
                    flow through unsaturated soils; these scenarios contain different boundary conditions
                    and model
                    parameters to see how the model results change with under varying conditions. The
                    scenarios will be
                    further detailed in an upcoming section.
                </p>

                <p>To model the unsaturated flow, discretization was used in a one-dimensional staggered
                    grid scheme to capture the flow in a continuous way through small time steps and depth
                    increments. The
                    nodes represent the soil layers, and the internodes represent the space between soil
                    layers as
                    shown in Figure 1.
                </p>

                <img class="img-fluid z-dept-1" src="images/StaggeredGridDualPorosity.png"
                    alt="StaggeredGridDualPorosity.png" />
                <div class="caption">
                    <em>Figure 1: Staggered grid scheme for discretization and dual porosity conceptual
                        model.</em>
                </div>

                <p> The discretization was then done using a Jacobian matrix for the Python ODE solver. To
                    couple the flows, two state variables were used throughout the model functions. The top
                    and bottom boundary conditions depended on the scenario. In the no flow top boundary
                    condition, the flow at the top is zero. In the varying top boundary condition, there is
                    a 0.001 m/day flow for the first 25 days, and then no flow for the next 200 days. In the
                    gravity flow bottom boundary condition, only gravity (a zero pressure head gradient)
                    impacts the bottom boundary. In the Robbin condition at the bottom boundary, the flow is
                    determined by the mixed Robbin condition which is the negative of the Robbin resistance
                    term multiplied by the difference between the water pressure head and the external head
                    of -1m. These values were given as part of the model for unsaturated flow.
                </p>

                <h4 id="parameter">Parameter Values and Initial Conditions</h4>
                <p>The initial conditions were given according to the model for unsaturated flow. The initial soil
                    column length was taken to be one meter and the phreatic water level was 25 centimeters. Therefore,
                    the initial pressure head was determined to be \(h_{w,initial} = zRef - zN\), where \(zRef\) is the
                    depth of the phreatic water table and \(zN\) is the depth. The initial pressure head at the top
                    boundary, \(zRef\), and bottom boundary were -0.25m, 0m, and 0.75m, respectively.
                </p>

                <p>The parameter values used in the model were the soil parameters from Gerke and Van Genuchten (1993).
                    Figure 2 shows the soil parameters used in the Python code, where the fracture and matrix soil
                    parameters were taken to be the fast flow and slow flow fractions, respectively.
                </p>


                <img class="img-fluid z-dept-1" src="images/soilParGerke.png" alt="soilParGerke.png" />
                <div class="caption">
                    <em>Figure 2: Soil parameters for different soil fractions in dual porosity flow (Gerke and Van
                        Genuchten, 1993).</em>
                </div>

                <p>These parameters were determined to be the best ones to use after calibrating the model with
                    different soil parameters and testing the sensitivity of changes in soil parameters on the model
                    outcomes. For example, using the sand and silty clay parameters from Mayer (2005) as shown in Figure
                    13 in the Appendix, the results as shown in Figure 20 were produced. The slow flow soil had a
                    significant negative pressure head. This indicates that the water is draining very quickly out of
                    the slow flow soil column. The flow of water is influenced by hydraulic conductivity. When the
                    hydraulic conductivity in the slow flow fraction was changed to be 0.01 m/day, comparable to the
                    value indicated in Gerke and Van Genuchten (1993), the pressure head in the slow flow fraction was
                    much less negative, which confirms that the hydraulic conductivity influences the flow as shown in
                    Figure 2. A lower permeability means there is slower flow. Then, the sensitivity of the saturated
                    water content was tested by raising it; the results are shown in Figure 2. Again, the pressure head
                    in the slow flow column was much less negative. With a higher saturated water content, the water
                    storage also increases. The higher saturation capacity means that more soil pores are filled with
                    and conducting water; the water does not drain as quickly. Therefore, a higher saturation water
                    content as determined by Gerke and Van Genuchten
                </p>

                <h2 id="scenarios"><b>Scenarios</b></h2>

                <h4 id="scenario1"><b>Gravity flow bottom boundary and</b> \(k_{ex}=0\)</h4>
                <p>When \(k_{ex}=0\), there is no exchange between the two soil fractions. In the first 25 days, there
                    is an inflow at the top boundary condition of the fast flow fraction, so the water pressure head
                    steadily decreases during this time. Then, a flow is introduced at the top boundary at Day 25, which
                    recharges the soil column with a steady water flow, bringing the pressure head to a steady level.
                    Meanwhile, as there is no exchange, the slow flow fraction is in hydrostatic conditions because
                    there is no inflow in the slow flow fraction. This is exhibited by the constant pressure change in
                    the vertical direction. Since the flow of water in the slow flow zone is only influenced by the
                    density, gravity, and change in depth under hydrostatic conditions, the pressure head change is only
                    due to the weight of the fluid as it trickles down the slow flow column. The inflow in the fast flow
                    column is too slow to sustain the water content, so at the end of the model run, it drops to the
                    residual water content. In the slow flow zone, it does not reach the residual water content as the
                    water content barely changes with respect to depth. From the graphs, it is clear that the water
                    enters through the fast flow domain and flows faster through the fast flow soil fraction than the
                    slow flow fraction.
                </p>
                <img class="img-fluid z-dept-1" src="images/1.B0.2Kex0Gravity.png" alt="1.B0.2Kex0Gravity.png" />
                <div class="caption">
                    <em>Figure 3: Results of the model where there is no exchange, gravity flow at the bottom boundary,
                        and β = 0.2.</em>
                </div>

                <h4 id="scenario2"><b>Robbin bottom boundary and</b> \(k_{ex}=0\)</h4>
                <p>This scenario is similar to that of the foregoing section, except that the bottom boundary is now a
                    Robbin boundary.
                </p>
                <img class="img-fluid z-dept-1" src="images/2.B0.2Kex0Robbin.png" alt="2.B0.2Kex0Robbin.png" />
                <div class="caption">
                    <em>Figure 4: Results of the model where there is no exchange, gravity flow at the bottom boundary,
                        and β = 0.2.</em>
                </div>

                <p>With the Robbin condition at the bottom boundary, there is an external head that limits the drop in
                    pressure head; the lowest pressure head in both columns is greater than the lowest pressure head in
                    the preceding scenario. For both soil columns, the pressure head converges to the external pressure
                    head at the bottom boundary over time. Moreover, the pressure head tends to stabilize over time in
                    both soil columns. In this scenario, it is evident that the slow flow fraction converges to a
                    residual water content level that is higher than the fast flow section. This makes sense as coarser
                    soil characteristics, such as sand, of the fast flow fraction make the residual water content lower
                    than the residual water content of the slow flow fraction that is driven by finer soil
                    characteristics like clay or organic matter. For most of the time, the flow through the fast flow
                    domain is faster than the flow through the slow flow domain except at deeper levels, as the external
                    head applied causes the flow in the slow flow domain to increase.
                </p>


                <h4 id="scenario3"><b>Gravity flow bottom boundary and</b> \(k_{ex}=1.05\times 10^{-5}\) \(m^2/day\)</h4>

                <p>To determine the value for \(k_{ex}\), it was assumed that a small wormhole or crack would have a
                    length dimension (dz) of \(10^{-3}\) m or 1mm. Using Darcy's Law and the equation for
                    \(Q_{exchange}\),
                    the \(k_{ex}\) could be determined by \(dz * K_{sat}\). Using the \(K_{sat}\) from the slow flow
                    regime,
                    which is \(0.010526\) \(m/day\), the \(k_{ex}\) was determined to be \(1.0526 \times 10^{-5}\)
                    \(m^2$/day\) for
                    this scenario.
                </p>
                <p>In the first 25 days when there is an inflow at the top boundary of the fast flow soil fraction, the
                    water drains out of the fast flow column. There is a higher pressure head gradient between the two
                    soil fractions during this time; therefore, the \(Q_{exchange}\) rapidly declines as the pressure
                    head
                    in the slow flow column is greater than the pressure head in the fast flow column. During this time,
                    the slow flow soil fraction is still in hydrostatic conditions. Once the inflow from the top stops
                    after Day 25, there is a dynamic interaction that happens between the two columns. At first, the
                    pressure head gradient starts to level out as the water continues to drain; as time goes on, there
                    is insufficient water inflow, and the soil gets increasingly more saturated, which causes a reversal
                    of the pressure gradient to favor the fast flow domain. The exchange changes to become negative,
                    signaling an exchange from the fast flow to slow flow soil fractions. This reversal of the sign of
                    \(Q_{exchange}\) shows that as the fast flow soil gets more saturated from the inflow of water at
                    the
                    top boundary, the exchange flow reverses. Therefore, preferential flow occurs due to the different
                    volumes of flow between the two zones; the water flows much faster through the fast flow zone due to
                    the cracks and coarse nature. Once it is saturated, it will exchange with the slow flow fraction.
                </p>


                <img class="img-fluid z-dept-1" src="images/3.B0.2Kex(-5)Gravity.png" alt="3.B0.2Kex(-5)Gravity.png" />
                <div class="caption">
                    <em>Figure 5: Results of the model where \(k_{ex}=1.05\times 10^{-5}\) \(m^2/day\), gravity flow at the
                        bottom boundary, and β = 0.2.</em>
                </div>


                <h4 id="scenario4"><b>Robbin bottom boundary and</b> \(k_{ex}=1.05\times 10^{-5}\) \(m^2/day\)</h4>

                <p>Notably, the \(k_{ex}\) set at the order of magnitude of \(10^{-5}\) \(m^2/day\)does not alter the
                    results
                    from the scenario with a Robbin bottom boundary and \(k_{ex} = 0\). Looking at the \(Q_{exchange}\)
                    graphs below, it is evident that the external pressure head causes a quick flow through the column
                    and the pressure head gradient quickly drops to zero. After the 25 day mark and over time,
                    \(Q_{exchange}\) becomes increasingly negative signifying the slight preferential flow through the
                    fast flow soil column as it has a higher hydraulic conductivity and there is not enough inflow to
                    sustain a high magnitude of exchange to the slow flow column. After day 25, the pressure head of the
                    fast flow fraction increases above the pressure head of the slow flow fraction.
                </p>


                <div class="text-center">
                    <img class="img-fluid z-dept-1" src="images/4.B0.2Kex(-5)RobbinQex.png"
                        alt="4.B0.2Kex(-5)RobbinQex.png" />
                    <div class="caption">
                        <em>Figure 6: \(Q_{exchange}\) graphs where \(k_{ex}=1.05\times 10^{-5}\) \(m^2/day\), Robbin
                            condition at the bottom boundary, and β = 0.2.</em>
                    </div>
                </div>


                <h4 id="scenario5"><b>Gravity flow bottom boundary and </b>\(k_{ex}=1.05\times 10^{-4}\) \(m^2/day\)</h4>

                <p>This scenario tests the sensitivity of the exchange resistance term by checking the model behavior if
                    the \(k_{ex}\) increases by one order of magnitude. More resistance means that it would be harder to
                    exchange between the soil columns, as exhibited by the graphs below. The flow through the soil
                    columns happens much faster. The pressure head gradient is much smaller between the two soil
                    fractions, so the magnitude of \(Q_{exchange}\) is small, and there is little exchange. Again, the
                    pressure head of the slow flow domain lags behind the fast flow domain, and the flow goes faster
                    through the fast flow zone than the slow flow zone. The bottom boundary of the fast flow domain
                    experiences higher drainage than the slow flow domain.
                </p>


                <img class="img-fluid z-dept-1" src="images/5.B0.2Kex(-4)Gravity.png" alt="5.B0.2Kex(-4)Gravity.png" />
                <div class="caption">
                    <em>Figure 7: \(Q_{exchange}\) graphs where \(k_{ex}=1.05\times 10^{-4}\) \(m^2/day\), gravity flow at
                        the bottom boundary, and β = 0.2.</em>
                </div>

                <h4 id="scenario6"><b>Robbin bottom boundary and </b>\(k_{ex}=1.05\times 10^{-4}\) \(m^2/day\)</h4>

                <p>Again, with the Robbin condition at the bottom boundary, the model behavior does not change compared
                    to the foregoing scenarios with a Robbin bottom boundary. However, in this case, the magnitude of
                    the \(Q_{exchange}\) is even smaller; it, therefore, makes sense that there would not be enough
                    exchange in this case to change the model results.
                </p>


                <div class="text-center">
                    <img class="img-fluid z-dept-1" src="images/5.B0.2Kex(-4)Robbin.png" alt="5.B0.2Kex(-4)Robbin.png"
                        style="width: 55%;" />
                    <div class="caption">
                        <em>Figure 8: \(Q_{exchange}\) graphs where \(k_{ex}=1.05\times 10^{-4}\) \(m^2/day\), Robbin
                            condition at the bottom boundary, and β = 0.2.</em>
                    </div>
                </div>

                <h4 id="scenario7"><b>Gravity flow bottom boundary and </b>\(k_{ex}=1.05\times 10^{-5}\) \(m^2/day\) <b>with
                        ponding at the top of the slow flow fraction and a varying top boundary</b></h4>

                <p>In this scenario, the top boundary condition for the slow flow fraction is assumed to be the same as
                    the fast flow faction (previously, it was assumed that the flow only entered via the fast flow
                    fraction only). When the flow is too slow at the top boundary of the slow flow fraction, ponding
                    occurs where the additional water flux will create infiltration of water into the soil. The extra
                    infiltration sustains the pressure head in the slow flow column after there is a reversal of the
                    direction of \(Q_{exchange}\) after 25 days. The larger magnitude of the \(Q_{exchange}\) term shows
                    that the pressure gradient is highest in this scenario than the preceding scenarios, indicating more
                    significant exchange between the two soil columns. The ponding allows for the model to continue
                    working even after the soil hits full saturation by switching to the Dirichlet boundary condition.
                    It is evident that in this situation, the pressure head of the slow flow soil fraction still lags
                    behind the fast flow soil fraction. Most of the flow from both the top boundary condition and
                    spillover from the slow flow domain still enters the fast flow domain first as the water flows
                    faster through the fast flow column.
                </p>

                <img class="img-fluid z-dept-1" src="images/6.B0.2Kex(-5)GravityPonding.png"
                    alt="6.B0.2Kex(-5)GravityPonding.png" />
                <div class="caption">
                    <em>Figure 9: Results of the model with ponding in slow flow fraction, \(k_{ex}=1.05\times 10^{-5}\)
                        \(m^2/day\), gravity flow at
                        the bottom boundary, and β = 0.2.</em>
                </div>
                <p>When the pressure heads between the two domains are equal, there is no exchange as exhibited by the
                    foregoing scenarios. Therefore, below the depth at which the pressure heads are equal will also be
                    saturated. It is expected that if the inflow of water at the top boundary conditions exceeds the
                    infiltration rate, not only will the soil columns be fully saturated, the water table will also
                    rise. This increases more of the saturated zone. In the next scenario, more inflow will be modeled
                    to examine the effects of higher inflow and potential rise in water table.
                </p>

                <h4 id="scenario8"><b>Gravity flow bottom boundary and </b>\(k_{ex}=1.05\times 10^{-5}\) \(m^2/day\) <b>with
                        ponding at the top of the slow flow fraction and a varying top boundary with higher inflow</b>
                </h4>
                <p>In this scenario, the top boundary condition was doubled, and both the fast and slow flow top
                    boundaries had this inflow condition. As exhibited by the \(Q_{exchange}\) graphs in Figure 10, as
                    time goes by, the depth at which there is no more exchange starts to become increasingly deeper. At
                    the depth where \(Q_{exchange}\) becomes zero and below, there is no exchange because the higher
                    inflow causes the soil to be fully saturated at that depth as the water flows through the soil
                    column. Because there is slow flow in the slow flow domain, ponding occurs which causes the flow to
                    move horizontally to the fast flow domain, as there is too much inflow at the top boundary; this is
                    exhibited by the positive \(Q_{exchange}\) term at the soil layers closer to the top, especially at
                    the beginning of model simulation. As time goes by and as certain soil layers get saturated in the
                    fast flow column, the exchange of flow reverses so that \(Q_{exchange}\) flows from fast to slow
                    flow
                    domains. Moreover, as the flow starts to be insufficient to penetrate to the even deeper layers of
                    the soil, the exchange flow starts to reverse due to the difference in level of saturation between
                    the fast and slow flow domains that changes.
                </p>

                <img class="img-fluid z-dept-1" src="images/7.B0.2Kex(-5)GravityPondingHighInflow.png"
                    alt="7.B0.2Kex(-5)GravityPondingHighInflow.png" />
                <div class="caption">
                    <em>Figure 10: Results of the model with ponding in slow flow fraction, higher inflow,
                        \(k_{ex}=1.05\times 10^{-5}\)
                        \(m^2/day\), gravity flow at
                        the bottom boundary, and β = 0.2.</em>
                </div>

                <p>The inflow was increased further to see its effects on the coupled process between the two domains.
                    At a higher inflow at the top boundary of the slow flow and fast flow columns, ponding is more
                    severe; therefore, the \(Q_{exchange}\) remains positive for the entire model run. Yet, the flow
                    through the fast column is still faster than the flow through the slow flow column.
                </p>

                <img class="img-fluid z-dept-1" src="images/8.B0.2Kex(-5)GravityPondingHigherInflow.png"
                    alt="8.B0.2Kex(-5)GravityPondingHigherInflow.png" />
                <div class="caption">
                    <em>Figure 11: Results of the model with ponding in slow flow fraction,
                        \(k_{ex}=1.05\times 10^{-5}\)
                        \(m^2/day\), gravity flow at
                        the bottom boundary, β = 0.2, and a constant top boundary condition of -0.01 m/day.</em>
                </div>

                <p>Interestingly, if the top boundary of the slow flow domain was set to no flow, the \(Q_{exchange}\)
                    term becomes negative over time, as there is exchange from the fast flow domain to the slow flow
                    domain because the fast flow domain is more saturated.
                </p>

                <img class="img-fluid z-dept-1" src="images/8.B0.2Kex(-5)GravityPondingHigherInflowNOFLOw.png"
                    alt="8.B0.2Kex(-5)GravityPondingHigherInflowNOFLOw.png" />
                <div class="caption">
                    <em>Figure 12: Results of the model with ponding in slow flow fraction,
                        \(k_{ex}=1.05\times 10^{-5}\)
                        \(m^2/day\), gravity flow at
                        the bottom boundary, β = 0.2, and a no flow top boundary condition for the slow flow
                        domain.</em>
                </div>

                <h2 id="conclusion">Conclusion</h2>
                <p>Preferential flow is driven by the difference in volume of flow through the fast flow and slow flow
                    columns as well as the differences in soil properties. With varying top boundary conditions, most of
                    the flow still enters through the fast flow soil domain. Therefore, it is a safe assumption to model
                    no flow through the top boundary of the slow flow soil fraction. The resistance term in the
                    \(Q_{exchange}\) term governs the exchange of flow between the two soil columns; the higher the
                    resistance, the less exchange there is. Changes in the \(Q_{exchange}\) term depend on the level of
                    saturation of both the fast and slow flow domains; this relation is what couples the process of
                    unsaturated flow between the dual porosity soil domains. Because of the different soil properties
                    between the two soil fractions, preferential flow can be observed as the water flows faster through
                    the coarser fraction than the finer fraction, making the residual water content in the slow flow
                    fraction higher than in the slow flow fraction. The pressure head of the slow flow domain lags
                    behind the pressure head of the fast flow domain; the difference in pressure head between the two
                    domains will impact the exchange. Preferential flow is also influenced by the boundary conditions;
                    with a high external head at the bottom boundary, the flow through the columns might be too fast for
                    there to be any sufficient exchange or the external head could influence the flow rate. Also, with a
                    large inflow and ponding occurring at the top of the slow flow domain, the flow will move laterally
                    to the fast flow domain. Overall, the cracks in the soil within the fast flow region imply that the
                    porosity of the fast flow domain is higher; moreover, the permeability is higher which makes water
                    prefer the flow through the fast flow domain.
                </p>

                <h4 id="future">Future Extensions of the Model</h4>

                <p>This model could be extended to further study the effects of coupled processes in preferential flow.
                    This model assumes that the soil parameters do not change with different depths, temperature, or
                    density. Making these parameters change concerning different environmental conditions will help
                    study the coupled process under varying conditions. Additionally, changing the boundary conditions
                    to observe how the model behaves differently could provide valuable insights.
                </p>
                <p>Other processes could be incorporated, such as root water uptake, to further extend the model.
                    Including meteorological data could simulate real-life situations with changing unsaturated flow due
                    to different inflow rates of water. Extending the model to include these scenarios will provide
                    deeper insight into the effects of the dual porosity system.
                </p>


                <h2 id="appendix">Appendix</h2>
                <p>To ensure the model used was set up correctly, the extension of the unsaturated flow model was done
                    in a step-wise fashion. The results of the extension are shown below. First, both the fast and slow
                    soil fractions were set to the same soil parameters which was sand according to the parameters
                    denoted in Mayer (2005) who cited Carsel & Parrish (1988).
                </p>

                <img class="img-fluid z-dept-1" src="images/soilParMayer.png" alt="soilParMayer.png" />
                <div class="caption">
                    <em>Figure 13: Soil parameters for 12 major soil groups (Mayer, 2005).</em>
                </div>

                <br><br>

                <img class="img-fluid z-dept-1" src="images/SameSoilPar1(GravityBot).png"
                    alt="SameSoilPar1(GravityBot).png" />
                <div class="caption">
                    <em>Figure 14: Both fast and slow soil fractions have the same soil properties, no flow top boundary
                        condition,
                        gravity flow at the bottom boundary, no exchange, and equal partition of volume between the two
                        flows.</em>
                </div>
                <p>Figures 14 and 15 show the results of the model when the bottom boundary condition was gravity flow
                    and the Robbin condition, respectively, and both slow and fast fractions had the same soil
                    conditions, no exchange, and equal partition between the two soil fractions. These graphs match the
                    unsaturated flow model.
                </p>

                <img class="img-fluid z-dept-1" src="images/SameSoilPar2(RobbinBot).png"
                    alt="SameSoilPar2(RobbinBot).png" />
                <div class="caption">
                    <em>Figure 15: Both fast and slow soil fractions have the same soil properties, no flow top boundary
                        condition,
                        Robbin condition at the bottom boundary, no exchange, and equal partition of volume between the
                        two flows.</em>
                </div>


                <p>Then, the top boundary condition was varied to -0.001 m/day of flow in the first 25 days, then zero
                    flow for the next 200 days. Again, these results match the results from the unsaturated flow model,
                    as shown in Figures 16 and 17.
                </p>


                <img class="img-fluid z-dept-1" src="images/SameSoilPar3(GravityBot,VaryTop).png"
                    alt="SameSoilPar3(GravityBot,VaryTop).png" />
                <div class="caption">
                    <em>Figure 16: Both fast and slow soil fractions have the same soil properties, varying top boundary
                        condition,
                        gravity flow at the bottom boundary, no exchange, and equal partition of volume between the two
                        flows.</em>
                </div>

                <br><br>

                <img class="img-fluid z-dept-1" src="images/SameSoilPar4(RobbinBot,VaryTop).png"
                    alt="SameSoilPar4(RobbinBot,VaryTop).png" />
                <div class="caption">
                    <em>Figure 17: Both fast and slow soil fractions have the same soil properties, varying top boundary
                        condition,
                        Robbin condition at the bottom boundary, no exchange, and equal partition of volume between the
                        two flows.</em>
                </div>

                <p>The code was then tested to ensure that \(\beta\) appropriately partitions the flow by volume between
                    the two soil fractions. Figures 18 and 19 show the results of the model when \(\beta = 0.2\), as
                    this
                    parameter which is the fraction of porosity associated with the fast flow is typically between
                    2-30%.
                </p>

                <img class="img-fluid z-dept-1" src="images/SameSoilPar5(B0.2,GravityBot,VaryTop).png"
                    alt="SameSoilPar5(B0.2,GravityBot,VaryTop).png" />
                <div class="caption">
                    <em>Figure 18: Both fast and slow soil fractions have the same soil properties, varying top boundary
                        condition,
                        gravity flow at the bottom boundary, no exchange, and β = 0.2.</em>
                </div>

                <br><br>

                <img class="img-fluid z-dept-1" src="images/SameSoilPar6(B0.2,RobbinBot,VaryTop).png"
                    alt="SameSoilPar6(B0.2,RobbinBot,VaryTop).png" />
                <div class="caption">
                    <em>Figure 19: Both fast and slow soil fractions have the same soil properties, varying top boundary
                        condition,
                        Robbin condition at the bottom boundary, no exchange, and β = 0.2.</em>
                </div>


                <p>The behavior of these graphs was as expected, and therefore the test scenarios could be modeled using
                    this Python code.
                </p>

                <h4 id="Determing Soil Parameters"></h4>

                <p>Figures 20, 21, and 22 show the sensitivity of changing soil parameters on the model behavior.
                </p>


                <img class="img-fluid z-dept-1" src="images/DiffSoilMayerSandSiltyClay.png"
                    alt="DiffSoilMayerSandSiltyClay.png" />
                <div class="caption">
                    <em>Figure 20: Results of the model using soil parameters determined by Mayer (2005) for sand (fast
                        flow) and silty clay (slow flow), with varying top boundary conditions, gravity flow at the
                        bottom boundary, no exchange between the two soil fractions, and β = 0.2.</em>
                </div>

                <br><br>

                <img class="img-fluid z-dept-1" src="images/DiffSoilMayerSandSiltyClay0.01.png"
                    alt="DiffSoilMayerSandSiltyClay0.01.png" />
                <div class="caption">
                    <em>Figure 21: Results of the model using a hydraulic conductivity for the slow flow zone of 0.01
                        m/day.</em>
                </div>

                <br><br>

                <img class="img-fluid z-dept-1" src="images/DiffSoilMayerSandSiltyClay0.08thetasat.png"
                    alt="DiffSoilMayerSandSiltyClay0.08thetasat.png" />
                <div class="caption">
                    <em>Figure 22: Results of the model using a hydraulic conductivity for the slow flow zone of 0.01
                        m/day and a saturated water content of 0.08.</em>
                </div>


                <h2 id="references">References</h2>

                <p style="margin-left: 1.5em; text-indent: -1.5em;">
                    Cornell University. (2021). <em>Why preferential flow is important?</em> Retrieved June 9, 2021,
                    from
                    <a
                        href="http://soilandwater.bee.cornell.edu/research/pfweb/educators/intro/why.htm">http://soilandwater.bee.cornell.edu/research/pfweb/educators/intro/why.htm</a>
                </p>

                <p style="margin-left: 1.5em; text-indent: -1.5em;">
                    Gerke, H. H., & Van Genuchten, M. T. (1993). A dual-porosity model for simulating the preferential
                    movement of water and solutes in structured porous media.
                    <em>Water resources research, 29</em>(2), 305–319.
                </p>

                <p style="margin-left: 1.5em; text-indent: -1.5em;">
                    Mayer, A. S. (2005). <em>Soil and groundwater contamination: Nonaqueous phase liquids.</em> American
                    Geophysical Union.
                </p>

                <p style="margin-left: 1.5em; text-indent: -1.5em;">
                    Pinder, G. F., & Celia, M. A. (2006). <em>Subsurface hydrology.</em> John Wiley & Sons.
                </p>


            </article>
        </div>
    </div>

    <!-- Footer -->
    <footer class="fixed-bottom">
        <div class="container mt-0">
            <!-- © Copyright 2022 Eunice Koid. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. -->

        </div>
    </footer>

    <!-- JavaScripts -->


    <!-- jQuery -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js"
        integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js"
        integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js"
        integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
    <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js"
        integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
    <script defer src="/assets/js/masonry.js" type="text/javascript"></script>

    <!-- Medium Zoom JS -->
    <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"
        integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
    <script src="/assets/js/zoom.js"></script><!-- Load Common JS -->
    <script src="/assets/js/common.js"></script>

    <!-- MathJax -->
    <script type="text/javascript">
        window.MathJax = {
            tex: {
                tags: 'ams'
            }
        };
    </script>
    <script defer type="text/javascript" id="MathJax-script"
        src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
    <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


</body>

</html>